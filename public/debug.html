<!DOCTYPE html>
<html>
<head>
  <title>Quick Join Test</title>
  <style>
    body {
      font-family: monospace;
      padding: 20px;
      background: #0a0a0a;
      color: #0ff;
    }
    button {
      background: #0ff;
      color: #000;
      border: none;
      padding: 10px 20px;
      margin: 10px;
      cursor: pointer;
      font-size: 16px;
    }
    button:hover {
      background: #0cc;
    }
    .box {
      border: 2px solid #0ff;
      padding: 20px;
      margin: 20px 0;
    }
    pre {
      background: #1a1a1a;
      padding: 10px;
      overflow-x: auto;
    }
  </style>
</head>
<body>
  <h1>üîß Quick Join Debug Tool</h1>
  
  <div class="box">
    <h2>Current Status</h2>
    <div id="status"></div>
  </div>

  <div class="box">
    <h2>Actions</h2>
    <button onclick="checkStorage()">Check LocalStorage</button>
    <button onclick="clearStorage()">Clear Player Name</button>
    <button onclick="clearAll()">Clear All Data</button>
    <button onclick="testQuickJoin()">Test QuickJoin</button>
  </div>

  <div class="box">
    <h2>Test Links</h2>
    <div id="links"></div>
  </div>

  <div class="box">
    <h2>Output</h2>
    <pre id="output">Ready...</pre>
  </div>

  <script>
    function log(msg) {
      const output = document.getElementById('output');
      output.textContent += msg + '\n';
    }

    function checkStorage() {
      const name = localStorage.getItem('chess_player_name');
      document.getElementById('status').innerHTML = `
        <strong>Player Name in LocalStorage:</strong> ${name || '<span style="color: #f80;">NONE (QuickJoin will show!)</span>'}
      `;
      log(`‚úì Checked storage: ${name || 'EMPTY'}`);
      
      if (name) {
        log(`‚ö†Ô∏è Name is saved! QuickJoin will be SKIPPED.`);
        log(`üí° Click "Clear Player Name" to test QuickJoin`);
      } else {
        log(`‚úÖ No name saved! QuickJoin WILL show!`);
      }
    }

    function clearStorage() {
      localStorage.removeItem('chess_player_name');
      log('‚úì Cleared player name from localStorage');
      log('‚úÖ QuickJoin will now show when you visit a game URL!');
      checkStorage();
    }

    function clearAll() {
      localStorage.clear();
      log('‚úì Cleared ALL localStorage');
      log('‚úÖ Fresh start!');
      checkStorage();
    }

    function testQuickJoin() {
      // Create a test game URL
      const testCode = 'TEST' + Math.random().toString(36).substring(2, 6).toUpperCase();
      const url = `http://localhost:8080/?game=${testCode}`;
      
      log(`\nüéÆ Test Game URL created:`);
      log(`   ${url}`);
      log(`\nüìã Steps to test:`);
      log(`   1. Make sure player name is cleared (click "Clear Player Name")`);
      log(`   2. Create a real game in your app`);
      log(`   3. Copy the URL from your browser`);
      log(`   4. Open in incognito/private window`);
      log(`   5. QuickJoin page should appear! ‚úÖ`);
      
      // Generate test links
      const links = document.getElementById('links');
      links.innerHTML = `
        <p>Create a game, then use these links to test:</p>
        <ul>
          <li><a href="http://localhost:8080/?game=TEST123" target="_blank">Test Link 1</a></li>
          <li><a href="http://localhost:8080/?game=TEST456" target="_blank">Test Link 2</a></li>
          <li><a href="http://192.168.0.103:8080/?game=TEST789" target="_blank">Test Link 3 (Network)</a></li>
        </ul>
        <p><strong>‚ö†Ô∏è Make sure to clear player name first!</strong></p>
      `;
    }

    // Run on load
    checkStorage();
    log('üöÄ Debug tool ready!');
    log('Click "Check LocalStorage" to see current state');
  </script>
</body>
</html>
